<WelcomeScreen>:
    MDBoxLayout:
        orientation: 'vertical'
        padding: "50dp"
        spacing: "50dp"
        size_hint_y:1
        

        # Centered Label
        MDLabel:
            text: 'Home Service Provider'
            font_style: "H5"
            halign: "center"
            theme_text_color: "Custom"
            text_color: 0, 0, 0, 1
            bold: True
            size_hint_y: None
            height: "50dp"
        
        # Spacer to align buttons properly
        Widget:
            size_hint_y: 0.4

        # First Button: Book Services
        MDRoundFlatButton:
            text: 'Book Services'
            font_size: "16sp"
            size_hint: 0.6, None
            height: "50dp"
            pos_hint: {"center_x": 0.5}
            md_bg_color: 0, 0.5, 1, 1
            text_color: 1, 1, 1, 1
            on_press: root.goto_user_login()

        # Second Button: Service Provider Login
        MDRoundFlatButton:
            text: 'Service Provider'
            font_size: "16sp"
            size_hint: 0.6, None
            height: "50dp"
            pos_hint: {"center_x": 0.5}
            md_bg_color: 0, 0.5, 1, 1
            text_color: 1, 1, 1, 1
            on_press: root.goto_serviceman_login()


#-------------------------------login screen
<UserLoginScreen>:
    MDBoxLayout:
        orientation: 'vertical'
        padding: [20, 40]
        spacing: 50
        size_hint_y:1

        # SIGN IN Label
        MDLabel:
            text: "SIGN IN"
            font_style: "H5"
            halign: "center"
            theme_text_color: "Custom"
            text_color: 0, 0, 0, 1
            bold: True
            size_hint_y: None
            height: "50dp"

        # Email TextField
        MDTextField:
            id: email
            hint_text: 'Enter your email...'
            mode: "line"
            size_hint: (0.8, None)
            height: "50dp"
            pos_hint: {'center_x': 0.5}
            font_size: "16sp"

        # Password TextField
        MDTextField:
            id: password
            hint_text: 'Enter your Password...'
            mode: "line"
            password: True
            size_hint: (0.8, None)
            height: "50dp"
            pos_hint: {'center_x': 0.5}
            font_size: "16sp"
        MDLabel:
            id: status_label
            text: ""
            halign: 'center'
            theme_text_color: "Error"
            size_hint_y: None
            height: dp(30)

        # Horizontal Layout for Sign-up
        MDBoxLayout:
            orientation: 'horizontal'
            size_hint: (0.8, None)
            height: "30dp"
            pos_hint: {'center_x': 0.5}
            spacing: 3

            MDLabel:
                text: "Don't have an account?"
                halign: "left"
                theme_text_color: "Custom"
                text_color: 1, 0, 0, 1
                font_size: "14sp"
                size_hint_x: 0.6

            MDTextButton:
                text: "Sign up here"
                font_size: "14sp"
                halign: "right"
                theme_text_color: "Custom"
                text_color: 0.27, 0.50, 0.70, 1
                size_hint_x: 0.4
                on_press: root.goto_signup()


        # Login Button
        MDRaisedButton:
            text: 'LOGIN'
            font_size: "16sp"
            size_hint: (0.6, None)
            height: "50dp"
            pos_hint: {'center_x': 0.5}
            md_bg_color: (0.27, 0.50, 0.70, 1)
            text_color: 1, 1, 1, 1
            on_press: root.login()

#---------------------------------------
<UserSignupScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: 50
        spacing: 20
        size_hint_y: 1
     # SIGN UP Label
        MDLabel:
            text: "SIGN UP"
            font_style: "H5"
            halign: "center"
            theme_text_color: "Custom"
            text_color: 0, 0, 0, 1
            bold: True
            size_hint_y: None
            height: "50dp"


        MDTextField:
            id: name
            hint_text: 'Full Name'
            multiline: False
            size_hint: (0.8, None)
            height: "40dp"
            pos_hint: {'center_x': 0.5}

        MDTextField:
            id: email
            hint_text: 'Email'
            multiline: False
            size_hint: (0.8, None)
            height: "40dp"
            pos_hint: {'center_x': 0.5}

        MDTextField:
            id: password
            hint_text: 'Password'
            password: True
            multiline: False
            size_hint: (0.8, None)
            height: "40dp"
            pos_hint: {'center_x': 0.5}

        MDTextField:
            id: phone
            hint_text: 'Phone Number'
            multiline: False
            size_hint: (0.8, None)
            height: "40dp"
            pos_hint: {'center_x': 0.5}

         # MDLabel to display messages dynamically
        MDLabel:
            id: status_label
            text: ""
            halign: 'center'
            theme_text_color: "Error"
            size_hint_y: None
            height: dp(30)

        MDRaisedButton:
            text: 'Sign Up'
            size_hint: (0.8, None)
            height: "40dp"
            pos_hint: {'center_x': 0.5}
            md_bg_color: (0.27, 0.50, 0.70, 1)
            on_press: root.signup()

        MDFlatButton:
            text: 'Back to Login'
            size_hint: (0.8, None)
            height: "40dp"
            pos_hint: {'center_x': 0.5}
            on_press: root.goto_login()

<UserDashboardScreen>
    name: "userdashboard"

    MDBoxLayout:
        orientation: 'vertical'

        MDTopAppBar:
            title: "Home Service Provider"
            md_bg_color: [0.13, 0.59, 0.95, 1]
            specific_text_color: "white"
            elevation: 0

        ScrollView:
            size_hint_y: None
            height: self.parent.height - dp(80)  # Adjust height to leave space for bottom navigation
            MDBoxLayout:
                orientation: 'vertical'
                padding: [dp(15), dp(10), dp(15), dp(15)]
                spacing: dp(10)
                size_hint_y: None
                height: self.minimum_height

                MDCard:
                    size_hint_y: None
                    height: search_field.height + dp(20)
                    padding: dp(10)
                    radius: [20]
                    elevation: 2
                    md_bg_color: "white"

                    MDTextField:
                        id: search_field
                        hint_text: "Search here..."
                        mode: "rectangle"
                        icon_right: "magnify"
                        on_text: root.search_services(self.text)

                MDBoxLayout:
                    id: services_container
                    orientation: 'vertical'
                    spacing: dp(15)
                    padding: dp(20)
                    size_hint_y: None
                    height: self.minimum_height
  
    # Bottom Toolbar
    # Bottom Toolbar
    # Bottom Toolbar
        MDBoxLayout:
            orientation: 'horizontal'
            size_hint_y: None
            height: dp(60)
            md_bg_color: [0.13, 0.59, 0.95, 1]  # Same panel color
            padding: [dp(15), dp(15), dp(15), dp(15)]
            spacing: dp(50)  # Adjust spacing between icons

            MDIconButton:
                icon: "home"
                theme_icon_color: "Custom"
                icon_color: "yellow" 
                icon_size: "28sp"
                on_release: root.manager.current = 'userdashboard'

            MDIconButton:
                icon: "book-clock"
                theme_icon_color: "Custom"
                
                icon_size: "28sp"
                on_release: root.manager.current = 'booking_history'

            MDIconButton:
                icon: "account"
                theme_icon_color: "Custom"
                
                icon_size: "28sp"
                on_release: root.manager.current = 'profile_screen'

<BookServiceScreen>
    name: "booking"

    ScrollView:
        MDBoxLayout:
            orientation: "vertical"
            size_hint_y: None
            height: self.minimum_height
            padding: dp(20)
            spacing: dp(20)

            MDLabel:
                text: "Book a Service"
                halign: "center"
                font_style: "H5"
                size_hint_y: None
                height: dp(50)

            MDTextField:
                id: date
                hint_text: "Enter Date (e.g., YYYY-MM-DD)"
                mode: "rectangle"
                size_hint_y: None
                height: dp(50)

            MDTextField:
                id: time
                hint_text: "Enter Time (e.g., HH:MM AM/PM)"
                mode: "rectangle"
                size_hint_y: None
                height: dp(50)

            MDTextField:
                id: location
                hint_text: "Enter Location"
                mode: "rectangle"
                size_hint_y: None
                height: dp(50)

            MDTextField:
                id: address
                hint_text: "Enter Address"
                mode: "rectangle"
                size_hint_y: None
                height: dp(50)

            MDTextField:
                id: mobile
                hint_text: "Enter Mobile Number"
                mode: "rectangle"
                size_hint_y: None
                height: dp(50)

            MDLabel:
                id: validation_label
                text: ""
                theme_text_color: "Error"
                halign: "center"
                size_hint_y: None
                height: dp(30)

            MDRaisedButton:
                text: "Confirm Booking"
                pos_hint: {"center_x": 0.5}
                size_hint_y: None
                height: dp(50)
                on_release: root.confirm_booking()

            MDTextButton:
                text: "Back to Dashboard"
                pos_hint: {"center_x": 0.5}
                size_hint_y: None
                height: dp(40)
                on_release: root.goto_dashboard()

<BookingHistoryScreen>
    name: "booking_history"

    MDBoxLayout:
        orientation: "vertical"

        # Scrollable content inside MDBoxLayout
        ScrollView:
            MDBoxLayout:
                orientation: "vertical"
                size_hint_y: None
                height: self.minimum_height
                padding: dp(20)
                spacing: dp(20)

                MDLabel:
                    text: "Booking History"
                    halign: "center"
                    font_style: "H5"
                    size_hint_y: None
                    height: dp(50)

                BoxLayout:
                    orientation: "vertical"
                    id: booking_history_box
                    size_hint_y: None
                    height: self.minimum_height
                    # This will be populated with booking history items dynamically

        # Add the Bottom Navigation outside of the ScrollView
     
        MDBoxLayout:
            orientation: 'horizontal'
            size_hint_y: None
            height: dp(60)
            md_bg_color: [0.13, 0.59, 0.95, 1]  # Same panel color
            padding: [dp(15), dp(10), dp(15), dp(10)]
            spacing: dp(30)  # Adjust spacing between icons

            MDIconButton:
                icon: "home"
                theme_icon_color: "Custom"
                
                icon_size: "28sp"
                on_release: root.manager.current = 'userdashboard'

            MDIconButton:
                icon: "book-clock"
                theme_icon_color: "Custom"
                icon_color: "yellow" 
                icon_size: "28sp"
                on_release: root.manager.current = 'booking_history'

            MDIconButton:
                icon: "account"
                theme_icon_color: "Custom"
                
                icon_size: "28sp"
                on_release: root.manager.current = 'profile_screen'

    
<ProfileScreen>
    name: "profile_screen"

    canvas.before:
        Color:
            rgba: 1, 1, 1, 1  # White background
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: "vertical"

        ScrollView:
            size_hint: (1, None)
            height: self.parent.height - dp(60)  # Adjust height to fit the bottom navigation
            do_scroll_x: False  # Only vertical scrolling

            MDBoxLayout:
                orientation: "vertical"
                padding: dp(20)
                spacing: dp(20)
                size_hint_y: None
                height: self.minimum_height

                MDLabel:
                    text: "User Profile"
                    halign: "center"
                    font_style: "H5"
                    bold: True
                    size_hint_y: None
                    height: dp(50)

                MDBoxLayout:
                    orientation: "vertical"
                    spacing: dp(10)
                    size_hint_y: None
                    height: self.minimum_height

                    MDTextField:
                        id: name
                        hint_text: "Full Name"
                        mode: "rectangle"
                        disabled: True
                        text: ""

                    MDTextField:
                        id: email
                        hint_text: "Email"
                        mode: "rectangle"
                        disabled: True
                        text: ""

                    MDTextField:
                        id: phone
                        hint_text: "Mobile Number"
                        mode: "rectangle"
                        disabled: True
                        text: ""

                BoxLayout:
                    orientation: "horizontal"
                    spacing: dp(10)
                    size_hint_y: None
                    height: dp(50)

                    MDRaisedButton:
                        text: "Edit Profile"
                        md_bg_color: 0.13, 0.59, 0.95, 1
                        on_release: root.enable_edit_mode()

                    MDRaisedButton:
                        text: "Save Profile"
                        md_bg_color: 0.13, 0.59, 0.95, 1
                        on_release: root.save_profile()

                MDBoxLayout:
                    orientation: "vertical"
                    spacing: dp(10)
                    size_hint_y: None
                    height: self.minimum_height

                    MDTextField:
                        id: old_password
                        hint_text: "Old Password"
                        mode: "rectangle"
                        password: True

                    MDTextField:
                        id: new_password
                        hint_text: "New Password"
                        mode: "rectangle"
                        password: True

                MDRaisedButton:
                    text: "Change Password"
                    md_bg_color: 0.95, 0.3, 0.3, 1
                    on_release: root.change_password()

                MDLabel:
                    id: notification_label
                    text: ""
                    halign: "center"
                    size_hint_y: None
                    height: dp(30)
                    theme_text_color: "Custom"
                    text_color: 0.95, 0.3, 0.3, 1

       # Bottom Toolbar
        MDBoxLayout:
            orientation: 'horizontal'
            size_hint_y: None
            height: dp(60)
            md_bg_color: [0.13, 0.59, 0.95, 1]  # Same panel color
            padding: [dp(15), dp(10), dp(15), dp(10)]
            spacing: dp(30)  # Adjust spacing between icons

            MDIconButton:
                icon: "home"
                theme_icon_color: "Custom"
                
                icon_size: "28sp"
                on_release: root.manager.current = 'userdashboard'

            MDIconButton:
                icon: "book-clock"
                theme_icon_color: "Custom"
                
                icon_size: "28sp"
                on_release: root.manager.current = 'booking_history'

            MDIconButton:
                icon: "account"
                theme_icon_color: "Custom"
                icon_color: "yellow" 
                icon_size: "28sp"
                on_release: root.manager.current = 'profile_screen'

    
<ServiceManLoginScreen>
    BoxLayout:
        orientation: 'vertical'
        padding: 50
        spacing: 20
        size_hint_y: 1

       
     # SIGN UP Label
        MDLabel:
            text: "SERVICE MAN SIGN IN"
            font_style: "H5"
            halign: "center"
            theme_text_color: "Custom"
            text_color: 0, 0, 0, 1
            bold: True
            size_hint_y: None
            height: "50dp"   

        MDTextField:
            id: email
            hint_text: 'Email'
            mode:'line'
            multiline: False
            size_hint: (0.8, None)
            height: "40dp"
            pos_hint: {'center_x': 0.5}

        MDTextField:
            id: password
            hint_text: 'Password'
            password: True
            mode:'line'
            multiline: False
            size_hint: (0.8, None)
            height: "40dp"
            pos_hint: {'center_x': 0.5}

           # MDLabel to display messages dynamically
        MDLabel:
            id: status_label
            text: ""
            halign: 'center'
            theme_text_color: "Error"
            size_hint_y: None
            height: dp(30)


        MDRaisedButton:
            text: 'Login'
            size_hint: (0.8, None)
            height: "40dp"
            pos_hint: {'center_x': 0.5}
            md_bg_color: (0.27, 0.50, 0.70, 1)
            on_press: root.login()

        MDFlatButton:
            text: 'If you dont have account? Sign Up here!'
            size_hint: (0.8, None)
            height: "40dp"
            pos_hint: {'center_x': 0.5}
            theme_text_color: "Custom"
            text_color: 0.27, 0.50, 0.70, 1
            on_press: root.goto_signup()


<ServiceManSignupScreen>
    ScrollView:
        BoxLayout:
            orientation: 'vertical'
            padding: dp(20)
            spacing: dp(10)
            size_hint_y: None  # Allow content to grow vertically
            height: self.minimum_height  # Ensures the BoxLayout grows based on content

            # Title label
            MDLabel:
                text: "SERVICE MAN SIGN UP"
                font_style: "H5"
                halign: "center"
                theme_text_color: "Custom"
                text_color: 0, 0, 0, 1
                bold: True
                size_hint_y: None
                height: "40dp"  # Height set to a fixed value for visibility

            MDTextField:
                id: name
                hint_text: 'Full Name'
                mode: "line"
                multiline: False
                size_hint: (0.8, None)
                height: "35dp"
                pos_hint: {'center_x': 0.5}

            MDTextField:
                id: email
                hint_text: 'Email'
                mode: "line"
                multiline: False
                size_hint: (0.8, None)
                height: "35dp"
                pos_hint: {'center_x': 0.5}

            MDTextField:
                id: password
                hint_text: 'Password'
                mode: "line"
                password: True
                multiline: False
                size_hint: (0.8, None)
                height: "35dp"
                pos_hint: {'center_x': 0.5}

            MDTextField:
                id: phone
                hint_text: 'Phone Number'
                mode: "line"
                multiline: False
                size_hint: (0.8, None)
                height: "35dp"
                pos_hint: {'center_x': 0.5}

            MDTextField:
                id: profession
                hint_text: 'Profession'
                mode: "line"
                multiline: False
                size_hint: (0.8, None)
                height: "35dp"
                pos_hint: {'center_x': 0.5}

            MDTextField:
                id: experience
                hint_text: 'Experience (in years)'
                mode: "line"
                multiline: False
                size_hint: (0.8, None)
                height: "35dp"
                pos_hint: {'center_x': 0.5}

            MDTextField:
                id: location
                hint_text: 'Location'
                mode: "line"
                multiline: False
                size_hint: (0.8, None)
                height: "35dp"
                pos_hint: {'center_x': 0.5}

            MDLabel:
                id: status_label
                text: ""
                halign: 'center'
                theme_text_color: "Error"
                size_hint_y: None
                height: dp(25)  # Reduced height

            MDRaisedButton:
                text: 'Sign Up'
                size_hint: (0.8, None)
                height: "40dp"
                pos_hint: {'center_x': 0.5}
                md_bg_color: (0.27, 0.50, 0.70, 1)
                on_press: root.signup()

            MDFlatButton:
                text: 'Back to Login'
                size_hint: (0.8, None)
                height: "40dp"
                pos_hint: {'center_x': 0.5}
                on_press: root.goto_login()

<ServiceManDashboardScreen>
    MDBoxLayout:
        orientation: 'vertical'
        padding: dp(20)
        spacing: dp(10)
        
        MDLabel:
            text: 'Service Provider Dashboard'
            font_style: 'H4'
            adaptive_height: True
            halign: 'center'
            
        MDScrollView:
            MDGridLayout:
                id: bookings_grid
                cols: 1
                spacing: dp(10)
                padding: dp(10)
                adaptive_height: True
                
        MDScrollView:
            MDGridLayout:
                id: services_grid
                cols: 1
                spacing: dp(10)
                padding: dp(10)
                adaptive_height: True

        MDRaisedButton:
            text: 'Add New Service'
            pos_hint: {'center_x': .5}
            md_bg_color: 0.2, 0.8, 0.2, 1
            on_release: root.show_add_service()

        MDRaisedButton:
            text: 'Logout'
            pos_hint: {'center_x': .5}
            md_bg_color: 0.8, 0.2, 0.2, 1
            on_release: root.logout()